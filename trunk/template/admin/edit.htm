<!--<?php
print <<<EOT
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>CMS - Powered by PHPWind.Net</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link type="text/css" href="style/admin/admin.css" rel="stylesheet" />
<script type="text/javascript" src="script/jquery.js"></script>
<script type="text/javascript" src="script/jquery.wysiwyg.js"></script>
<script type="text/javascript" src="script/jquery.cms.js"></script>
</head>

<body>
<!--
EOT;
if(!$this->cid){
print <<<EOT
-->
<form action="$basename" method="post">
<div class="t">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr class="head">
    <td colspan="2">请选择您要发布内容的栏目</td>
    </tr>
  <tr class="line">
    <td>&nbsp;</td>
    <td><select name="cid" id="cid">
	请选择栏目
	$cate_select
    </select>
    </td>
  </tr>
  <tr class="line">
    <td colspan="2">&nbsp;</td>
    </tr>
</table>
</div>
<div class="sub">
<input name="" type="submit" value="提交" class="btn" />
</div>
</form>
<!--
EOT;
}else{
print <<<EOT
-->
<style>
.menu{position:absolute;background:#fff;border:1px solid #69788c;}
.menu td, .menu li{background:#e6f5ff;}
.menu li{list-style:none;padding:0;}
.menu a{display:block;padding:3px 15px 3px 15px}
.menu a:hover{background:#e6f5ff;text-decoration:none;color:#fff;}
.menu ul.ul1 li a{display:inline;padding:0}
#colorbox{width:91px;height:78px;padding:3px 0 0 3px;overflow:hidden;}
#colorbox div{cursor:pointer;width:8px;height:8px;float:left;margin:0 3px 3px 0;border:1px #000 solid;font:0/8px arial}
</style>
<div class="menu" id="menu_editor" style="display:none;"></div>
<div id="showmenu" style="z-index:100;display:none;"></div>
<script language="javascript" src="script/global.js"></script>
<div class="t">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td>栏目切换&nbsp;&nbsp;&nbsp;
        <select name="menu1" onchange="window.location='$basename&cid='+this.value;">
		$cate_select
	    </select>
		<input type="button" name="Submit5" value="设置本栏目" class="btn" onclick="window.location='$admin_file?adminjob=category&action=edit&action=edit&cid=$cid';"/>

		<input type="button" value="查看栏目下所有内容" class="btn" onclick="window.location='$admin_file?adminjob=content&action=view&cid=$cid';" />
      </td>
  </tr>
</table>
</div>
<form action="$basename" method="post" name="FORM">
<div class="t">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr class="head">
    <td colspan="2">$catename
<!--
EOT;
if($action=='add'){
print <<<EOT
-->
	添加内容
<!--
EOT;
}elseif($action=='edit'){
print <<<EOT
-->
	编辑内容
<!--
EOT;
}print <<<EOT
-->	</td>
    </tr>
  <tr class="tr2">
    <td width="15%" style="text-align:center">字段名</td>
    <td width="85%" style="text-align:center">内容</td>
  </tr>
  <tr class="line">
    <td>推荐</td>
    <td>
			<input type="radio" value="0" name="digest" $digest_0 /> 普通主题
			<input type="radio" value="1" name="digest" $digest_1 /> 栏目推荐
			<input type="radio" value="2" name="digest" $digest_2 /> 站点推荐
			<input type="radio" value="3" name="digest" $digest_3 /> 头条推荐
		</td>
  </tr>
<!--
EOT;
foreach($inputArea as $value){
if($value[fieldid]=='title'){
print <<<EOT
-->
	<tr class="line">
    <td>$value[fieldname]</td>
    <td>$value[input]</td>
	<tr class="line">
    <td>$value[fieldname]字体</td>
    <td><select name="titlecolor" id="titlecolor">
	    <option value="">标题颜色</option>
$color_select</select>
	    <input name="titleb" type="checkbox" id="titleb" value="1" $titleb_check>
	    粗体
	    <input name="titleii" type="checkbox" id="titleii" value="1" $titleii_check>
	    斜体
	    <input name="titleu" type="checkbox" id="titleu" value="1" $titleu_check>
	    下划线
		</td>
  </tr>
<!--
EOT;
}else{
print <<<EOT
-->
  <tr class="line">
    <td>$value[fieldname]</td>
    <td>$value[input]</td>
  </tr>
<!--
EOT;
}}print <<<EOT
-->
  <tr class="line">
    <td>相关图片</td>
    <td><input type="text" name="photo" id="photo" value="$photo" size="70" class="txt" />
      <img src='images/admin/image_plus.gif' style='cursor:pointer;' align='absmiddle' onclick="selectImg('photo');">
      该字段标志着主题是否属于图文主题</td>
  </tr>
  <tr class="line">
    <td>外部链接</td>
    <td><input type="text" name="linkurl" id="linkurl" value="$linkurl" size="70" class="txt" />  </td>
  </tr>
  <tr class="line">
	  <td>自定义时间</td>
	  <td><input type="text" name="postdate" id="postdate" value="$postdate" size="70" class="txt">
		<img src='images/admin/clock_plus.gif' style='cursor:pointer;' align='absmiddle' onclick="ShowCalendar('postdate');"></td>
  </tr>
  <tr class="line">
	  <td>自定义模板</td>
	  <td><input type="text" name="template" id="template" value="$template" size="70" class="txt" />
		<img src="images/admin/globe_plus.gif" onclick="selectTpl('template');" width="16" height="16" align="absmiddle" style="cursor:pointer" /></td>
  </tr>
  <tr class="line">
		<td>当前Tags</td>
		<td><input type="text" name="tags" id="tags" size="70" value="$tags"  onfocus="showtag();" class="txt" />
		标签之间请使用逗号,最多5个<br />
		<fieldset id="tags_show" style="width:70%;display:none;"><legend>热门标签</legend><div id="hottags" style="height:80px;overflow-Y:auto;"></div></fieldset></td>
  </tr>
</table>
</div>
<div class="sub">
  <input name="step" type="hidden" id="step" value="2" />
  <input name="aid" type="hidden" id="aid" value="$aids" />
  <input name="tid" type="hidden" id="tid" value="$tid" />
  <input name="action" type="hidden" id="action" value="$action" />
  <input type="submit" name="submit" value="提交" class="btn" onclick="setselectvalue()" />
  <input type="reset" name="reset" value="重置" class="btn" />
</div>
</form>
<script language="javascript" src="script/xhr.js"></script>
<script language="javascript" src="script/date.js"></script>
<script language="javascript">
var tagsname = '$hottag';
var objts;
function IsBrowser(){
	var sAgent = navigator.userAgent.toLowerCase() ;
	if ( sAgent.indexOf("msie") != -1 && sAgent.indexOf("mac") == -1 && sAgent.indexOf("opera") == -1 )
		return "msie" ;
	if ( navigator.product == "Gecko" && !( typeof(opera) == 'object' && opera.postError ) )
		return "gecko";
	if ( navigator.appName == 'Opera')
		return "opera" ;
	if ( sAgent.indexOf( 'safari' ) != -1 )
		return "safari";
	return false ;
}

function selectImg(inputname){
	var time = new Date();
	var timestamp = time.valueOf();
	if(IsBrowser()=='msie'){
		objts=showModalDialog("$basename&action=addimage&inputtype=input&inputname="+inputname+"&time="+timestamp,window,'dialogWidth=650px;dialogHeight=500px;help:no;status:no;');
	}else{
		window.open("$basename&action=addimage&inputtype=input&inputname="+inputname+"&time="+timestamp,"selectimg","width=840,height=500,resizable=no,z-look=yes,alwaysRaised=yes,depended=yes,scrollbars=yes,left=" + (window.screen.width-840)/2 + ",top=" + (window.screen.height-500)/2);
	}
}

function selectAttach(inputname){
	var time = new Date();
	var timestamp = time.valueOf();
	if(IsBrowser()=='msie'){
		objts=showModalDialog("$basename&action=addattach&type=attach&inputtype=input&inputname="+inputname+"&time="+timestamp,window,'dialogWidth=650px;dialogHeight=500px;help:no;status:no;');
	}else{
		window.open("$basename&action=addattach&type=attach&inputtype=input&inputname="+inputname+"&time="+timestamp,"selectimg","width=840,height=500,resizable=no,z-look=yes,alwaysRaised=yes,depended=yes,scrollbars=yes,left=" + (window.screen.width-840)/2 + ",top=" + (window.screen.height-500)/2);
	}
}

function selectTids(inputname,inputtype){
	var time = new Date();
	var timestamp = time.valueOf();	window.open("$basename&action=selecttids&inputtype="+inputtype+"&inputname="+inputname+"&time="+timestamp,"sinavblogupload","width=840,height=500,resizable=no,z-look=yes,alwaysRaised=yes,depended=yes,scrollbars=yes,left=" + (window.screen.width-840)/2 + ",top=" + (window.screen.height-500)/2);

}

function add(inputname, tid, title){
	var obj = document.getElementById(inputname);
	if (optionExist(obj,tid)) {
		alert("该文章已添加");
		return false;
	}
	var length=obj.length;
	obj.options[length]=new Option(title,tid);

}

function optionExist(obj,tid){
	var isexit = false;
	for(var i=0;i<obj.options.length;i++){
		if(obj.options[i].value == tid){
			isexit = true;
			break;
		}
	}
	return isexit;
}

function moveUp(inputname){
	var obj = document.getElementById(inputname);
	with (obj){
		try {
			if(selectedIndex==0){
				options[length]=new Option(options[0].text,options[0].value);
				options[0]=null;
				selectedIndex=length-1;
			}else if(selectedIndex>0) moveG(obj,-1);
		}catch(e){}

	}
}

function moveDown(inputname){
	var obj = document.getElementById(inputname);
	with (obj){
		try {
			if(selectedIndex==length-1){
				var otext=options[selectedIndex].text;
				var ovalue=options[selectedIndex].value;
				for(i=selectedIndex; i>0; i--){
					options[i].text=options[i-1].text;
					options[i].value=options[i-1].value;
				}
				options[i].text=otext;
				options[i].value=ovalue;
				selectedIndex=0;
			}else if(selectedIndex<length-1){
				moveG(obj,+1);
			}
		} catch(e) {}
	}
}
function moveG(obj,offset){
	with (obj){
		desIndex=selectedIndex+offset;
		var otext=options[desIndex].text;
		var ovalue=options[desIndex].value;
		options[desIndex].text=options[selectedIndex].text;
		options[desIndex].value=options[selectedIndex].value;
		options[selectedIndex].text=otext;
		options[selectedIndex].value=ovalue;
		selectedIndex=desIndex;
	}
}
function del(inputname){
	var obj = document.getElementById(inputname);
	with(obj) {
		try {
			options[selectedIndex]=null;
			selectedIndex=length-1;
		}catch(e){}
	}
}

function setContentLinkValue(inputname){
	var obj = document.getElementById(inputname);
 	var returnValue = '';

	with(obj){
 		for(i=0; i <  obj.length ; i++){
			if(i==0){
				returnValue = options[i].value;
			}else{
				returnValue = returnValue + ',' + options[i].value;
			}
 		}
	}
	if(returnValue == 'undefined'){
		returnValue = '';
	}
 	return returnValue;
}
function setselectvalue(){
	var selectList =document.getElementsByTagName('select');
	var selectname;
	for(var i=0; i<selectList.length; i++){
		selectname = selectList[i]['id'];
		if(selectname !=false){
			try {
				var obj = document.getElementById(selectname+'_value');
			}catch(e){
				continue;
			}
			try {
				obj.value = setContentLinkValue(selectname);
				document.getElementById(selectname).value='';
			}catch (e) {
			}

		}
	}
}

function showtag(){
	var str='';
	tn = tagsname.split(',');
	for(i=0;i<tn.length;i++){
		str +='<a href="javascript:void(0)" onclick="SelectTag('+i+');">'+tn[i]+'</a>&nbsp;&nbsp;&nbsp;';
	}
	document.getElementById('hottags').innerHTML=str;
	document.getElementById('tags_show').style.display = '';
}

function SelectTag(id){
	tn = tagsname.split(',');
	tags = document.FORM.tags.value;
	if(tags.indexOf(tn[id])==-1 && tags.split(',').length<5){
		document.FORM.tags.value += document.FORM.tags.value ? ' , '+tn[id] : tn[id];
	}
}

function selectValue(inputname,value){
	if(value!=''){
		document.getElementById(inputname).value=value;
	}
}

function showColor(showName,inputName){
	var menu_editor = getObj("menu_editor");
	var colors = [
		'000000','660000','663300','666600','669900','66CC00','66FF00','666666','660066','663366','666666',
		'669966','66CC66','66FF66','CCCCCC','6600CC','6633CC','6666CC','6699CC','66CCCC','66FFCC','FF0000',
		'FF0000','FF3300','FF6600','FF9900','FFCC00','FFFF00','0000FF','FF0066','FF3366','FF6666','FF9966',
		'FFCC66','FFFF66','00FFFF','FF00CC','FF33CC','FF66CC','FF99CC','FFCCCC','FFFFCC'
	];
	var html = '<div id="colorbox">';
	for(i in colors){
		html += "<div unselectable=\"on\" style=\"background:#" + colors[i] + "\" onClick=\"SetC('" + colors[i] + "','" + inputName + "')\"></div>";
	}
	html += '</div>';
	menu_editor.innerHTML = html;
	if(typeof type == 'undefined'){
		click_open('menu_editor',showName,'2');
	} else{
		mouseover_open('menu_editor',showName,'2');
	}
}
function SetC(color,inputName){
	//var textValue = document.getElementById(inputName).value;
	//document.getElementById(inputName).value = "<span style=\"color:#"+color+";\">"+textValue+"</span>";
	document.getElementById(inputName).value = "#"+color;
	closep();
}

function selectTpl(name){
	window.open('$basename&action=selectTpl&inputname='+name,"selecttpl","width=840,height=500,resizable=no,z-look=yes,alwaysRaised=yes,depended=yes,scrollbars=yes,left=" + (window.screen.width-840)/2 + ",top=" + (window.screen.height-500)/2);
	return;
}
</script>

<!--
EOT;
}
print <<<EOT
-->
</body>
</html>
<!--
EOT;
?>-->